import pandas as pd


def generate_xml(article_df: pd.DataFrame) -> None:
    fw = open("./xml_covidence.xml", "w")

    fw.write('<?xml version="1.0" encoding="UTF-8" ?>\n')
    fw.write('  <xml>\n')
    fw.write('    <records>\n')
    fw.write('      <record>\n')
    fw.write('        <database name="My EndNote Library.enl"\
                path="C:\\Users\\D\\Documents\\My EndNote Library.enl">My EndNote Library.enl</database>\n')
    fw.write('        <source-app name="EndNote" version="18.2">EndNote</source-app>\n')
    fw.write('        <rec-number>83</rec-number>\n')
    fw.write('        <foreign-keys>\n')
    fw.write('          <key app="EN" db-id="0sex0zfdkxzw23ev0fjp55xkw9ewd9ee05vd">83</key>\n')
    fw.write('        </foreign-keys>\n')

    for i in range(len(article_df)):
        journal_name = article_df.iloc[i].title
        fw.write('        <ref-type name="' + journal_name + '">17</ref-type>\n')
        fw.write('        <contributors>')
        fw.write('        <authors>')
        authors = article_df.iloc[i].authors.split(";")
        for author in authors:
            fw.write('          <author>')
            fw.write('            <style face="normal" font="default" size="100%">' + author + '</style>')
            fw.write('          </author>')
        fw.write('        </contributors>')
        fw.write('        <auth-address>')
        fw.write('          <style face="normal" font="default" size="100%">"random- need to add later"</style>')
        fw.write('        </auth-address>')
        title = article_df.iloc[i].title
        fw.write('        <titles>')
        fw.write('          <title>')
        fw.write('            <style face="normal" font="default" size="100%">'+title+'</style>')
        fw.write('          </title>')
        fw.write('        <secondary-title>')
        fw.write('          <style face="normal" font="default" size="100%">add later</style>')
        fw.write('        </secondary-title>')
        fw.write('        </titles>')
        fw.write('        <periodical>')
        fw.write('          <full-title>')
        fw.write('            <style face="normal" font="default" size="100%">J Hosp Infect</style>')
        fw.write('          </full-title>')
        fw.write('        </periodical>')
        fw.write('        <pages>')
        fw.write('          <style face="normal" font="default" size="100%">438-444</style>')
        fw.write('        </pages>')
        fw.write('        <volume>')
        fw.write('          <style face="normal" font="default" size="100%">102</style>')
        fw.write('        </volume>')
        fw.write('        <number>')
        fw.write('          <style face="normal" font="default" size="100%">4</style>')
        fw.write('        </number>')
        fw.write('        <edition>')
        fw.write('          <style face="normal" font="default" size="100%">2019/04/01</style>')
        fw.write('        </edition>')
        fw.write('        <keywords>')
        fw.write('          <keyword>')
        fw.write('            <style face="normal" font="default" size="100%">Blood Culture/*methods</style>')
        fw.write('          </keyword>')
        fw.write('          <keyword>')
        fw.write('            <style face="normal" font="default" size="100%">Costs and Cost Analysis</style>')
        fw.write('          </keyword>')
        fw.write('          <keyword>')
        fw.write('            <style face="normal" font="default" size="100%">'
                 'Diagnostic Errors/economics/*prevention &amp; control</style>')
        fw.write('          </keyword>')
        fw.write('          <keyword>')
        fw.write('            <style face="normal" font="default" size="100%">'
                 'Health Care Costs/statistics &amp; numerical data</style>')
        fw.write('          </keyword>')
        fw.write('          <keyword>')
        fw.write('            <style face="normal" font="default" size="100%">Hospitals</style>')
        fw.write('          </keyword>')
        fw.write('          <keyword>')
        fw.write('            <style face="normal" font="default" size="100%">Humans</style>')
        fw.write('          </keyword>')
        fw.write('          <keyword>')
        fw.write('            <style face="normal" font="default" size="100%">'
                 'Length of Stay/statistics &amp; numerical data</style>')
        fw.write('          </keyword>')
        fw.write('          <keyword>')
        fw.write('            <style face="normal" font="default" size="100%">Retrospective Studies</style>')
        fw.write('          </keyword>')
        fw.write('          <keyword>')
        fw.write('            <style face="normal" font="default" size="100%">Specimen Handling/*methods</style>')
        fw.write('          </keyword>')
        fw.write('          <keyword>')
        fw.write('            <style face="normal" font="default" size="100%">United States</style>')
        fw.write('          </keyword>')
        fw.write('          <keyword>')
        fw.write('            <style face="normal" font="default" size="100%">Blood culture</style>')
        fw.write('          </keyword>')
        fw.write('          <keyword>')
        fw.write('            <style face="normal" font="default" size="100%">Contamination</style>')
        fw.write('          </keyword>')
        fw.write('          <keyword>')
        fw.write('            <style face="normal" font="default" size="100%">False-positive</style>')
        fw.write('          </keyword>')
        fw.write('            <keyword>')
        fw.write('              <style face="normal" font="default" size="100%">Quality of health care</style>')
        fw.write('            </keyword>')
        fw.write('        </keywords>')
        fw.write('        <dates>')
        fw.write('          <year>')
        fw.write('            <style face="normal" font="default" size="100%">2019</style>')
        fw.write('          </year>')
        fw.write('          <pub-dates>')
        fw.write('            <date>')
        fw.write('              <style face="normal" font="default" size="100%">Aug</style>')
        fw.write('            </date>')
        fw.write('          </pub-dates>')
        fw.write('        </dates>')
        fw.write('        <isbn>')
        fw.write('          <style face="normal" font="default" size="100%">'
                 '1532-2939 (Electronic)&#xD;0195-6701 (Linking)</style>')
        fw.write('        </isbn>')
        fw.write('        <accession-num>')
        fw.write('          <style face="normal" font="default" size="100%">30928573</style>')
        fw.write('        </accession-num>')
        abstract = article_df.iloc[i].abstract
        fw.write('        <abstract>')
        fw.write('          <style face="normal" font="default" size="100%">' + abstract + '</style>')
        fw.write('        </abstract>')
        fw.write('        <notes>')
        fw.write('          <style face="normal" font="default" size="100%">'
                 'Geisler, B P&#xD;Jilg, N&#xD;Patton, R G&#xD;Pietzsch, J B&#xD;eng&#xD;England&#xD;J '
                 'Hosp Infect. 2019 Aug;102(4):438-444. doi: 10.1016/j.jhin.2019.03.012. Epub 2019 Mar 27.</style>')
        fw.write('        </notes>')
        fw.write('        <urls>')
        fw.write('          <related-urls>')
        fw.write('            <url>')
        fw.write('              <style face="normal" font="default" size="100%">'
                 'https://www.ncbi.nlm.nih.gov/pubmed/30928573</style>')
        fw.write('            </url>')
        fw.write('            <url>')
        fw.write('              <style face="normal" font="default" size="100%">'
                 'https://www.journalofhospitalinfection.com/article/S0195-6701(19)30145-8/pdf</style>')
        fw.write('            </url>')
        fw.write('          </related-urls>')
        fw.write('          <pdf-urls>')
        fw.write('            <url>internal-pdf://4160569270/Geisler-2019-Model to evaluate the impact of h.pdf</url>')
        fw.write('          </pdf-urls>')
        fw.write('        </urls>')
        fw.write('        <electronic-resource-num>')
        fw.write('          <style face="normal" font="default" size="100%">10.1016/j.jhin.2019.03.012</style>')
        fw.write('        </electronic-resource-num>')
    fw.write('        </record>')
    fw.write('        </records>')
    fw.write('        </xml>')
